var e=Object.defineProperty,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,a=(t,o,n)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n,r=("undefined"!=typeof require&&require,(e,t,o)=>new Promise(((n,a)=>{var r=e=>{try{s(o.next(e))}catch(t){a(t)}},i=e=>{try{s(o.throw(e))}catch(t){a(t)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(r,i);s((o=o.apply(e,t)).next())})));import{_ as i,u as s}from"./useTable.7d8a6e5e.js";import{_ as l,u as d,a as c}from"./useForm.e9f08473.js";import{P as u}from"./index.24ce52d8.js";import{B as m,u as p,a as f}from"./index.21fd786f.js";import{a7 as g,m as h,B as b,j as I,N as x,n as j,O as y,V as v,Q as w,S as R,av as S,a1 as P}from"./vendor.8be1affb.js";import{s as M,h as T,i as C}from"./account.56f00c8e.js";import"./index.1c224cd3.js";import"./index.e1fec598.js";/* empty css              *//* empty css              *//* empty css              */import"./useContentViewHeight.1cc3b3a8.js";/* empty css              */import"./useSortable.92d684a3.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */const k=[{label:"域名",field:"Host",component:"Input",colProps:{span:4}},{label:"创建时间",field:"CreateTime",component:"RangePicker",componentProps:{"show-time":!0},colProps:{span:6}}],E=[{title:"编号",dataIndex:"Id",align:"center",width:80,sorter:!0},{title:"域名",dataIndex:"Host",align:"left",sorter:!0},{title:"状态",dataIndex:"IsLocked",align:"center",width:100,customRender:({record:e})=>e.IsLocked?g("span",{className:"page-lock"},"锁定"):g("span",{className:"page-unlock"},"启用"),filters:[{text:"锁定",value:1},{text:"启用",value:0}],sorter:!0},{title:"备注",dataIndex:"Id",align:"left",width:120,sorter:!0},{title:"创建时间",dataIndex:"CreateTime",width:160,sorter:!0}],O=[{label:"编号",field:"Id",defaultValue:0,component:"Input",show:!1},{label:"域名",field:"Host",defaultValue:"",component:"Input"},{label:"备注",field:"Remark",component:"InputTextArea",componentProps:{rows:6}},{label:"绑定帐号",field:"AccountId",component:"Select",componentProps:{options:[]}}];var A=h({name:"RoleEditorModal",components:{BasicModal:m,BasicForm:l},emits:["success"],setup(e,{emit:i}){const s=b({Id:0}),[l,{setFieldsValue:c,updateSchema:u,resetFields:m,validate:f}]=d({labelWidth:100,schemas:O,showActionButtonGroup:!1,actionColOptions:{span:25}}),[g,{setModalProps:h,closeModal:x}]=p((e=>r(this,null,(function*(){s.Id=e.Id,m(),h({confirmLoading:!0,maskClosable:!1});let r=[];try{let i=yield M({Id:e.Id});r=i.Account.map((e=>({label:e.LoginName,value:e.Id}))),c(((e,r)=>{for(var i in r||(r={}))o.call(r,i)&&a(e,i,r[i]);if(t)for(var i of t(r))n.call(r,i)&&a(e,i,r[i]);return e})({},i))}catch(i){}u([{field:"AccountId",componentProps:{options:r}}]),h({confirmLoading:!1})}))));return{registerModal:g,registerForm:l,getTitle:I((()=>0==s.Id?"创建站点":"编辑站点")),handleSubmit:function(){return r(this,null,(function*(){try{const e=yield f();h({confirmLoading:!0}),yield T(e),x(),i("success")}catch(e){}finally{h({confirmLoading:!1})}}))}}}});A.render=function(e,t,o,n,a,r){const i=x("BasicForm"),s=x("BasicModal");return j(),y(s,R(e.$attrs,{onRegister:e.registerModal,title:e.getTitle,onOk:e.handleSubmit}),{default:v((()=>[w(i,{onRegister:e.registerForm},null,8,["onRegister"])])),_:1},16,["onRegister","title","onOk"])};var B=h({name:"RoleManager",components:{PageWrapper:u,BasicTable:i,TableAction:c,SiteEditorModal:A},setup(){const[e,{openModal:t}]=f(),[o,{reload:n}]=s({title:"站点管理",canColDrag:!0,showIndexColumn:!1,striped:!0,canResize:!0,columns:E,api:C,formConfig:{labelWidth:80,schemas:k},useSearchForm:!0,showTableSetting:!0,bordered:!0,actionColumn:{width:200,title:"操作",dataIndex:"action",slots:{customRender:"action"},fixed:"right"},showSummary:!1});function a(e){t(!0,null==e?{Id:0}:e)}function r(){n()}return S("Enter",(e=>{var t;e.preventDefault(),"[object HTMLInputElement]"==(null==(t=e.target)?void 0:t.toString())&&r()})),{registerTable:o,handActionColumns:function(e){return[{title:"编辑",icon:"clarity:note-edit-line",onClick:()=>{a(e)}}]},registerSiteEditorModal:e,handleEdit:a,handleRefresh:r}}});const F=P("创建站点");B.render=function(e,t,o,n,a,r){const i=x("a-button"),s=x("TableAction"),l=x("BasicTable"),d=x("SiteEditorModal"),c=x("PageWrapper");return j(),y(c,{dense:"",contentFullHeight:"",fixedHeight:""},{default:v((()=>[w(l,{onRegister:e.registerTable},{toolbar:v((()=>[w(i,{type:"primary",onClick:t[0]||(t[0]=t=>e.handleEdit(null))},{default:v((()=>[F])),_:1})])),action:v((({record:t})=>[w(s,{actions:e.handActionColumns(t)},null,8,["actions"])])),_:1},8,["onRegister"]),w(d,{onRegister:e.registerSiteEditorModal,onSuccess:e.handleRefresh},null,8,["onRegister","onSuccess"])])),_:1})};export{B as default};
