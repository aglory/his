var e=Object.defineProperty,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,a=(t,o,n)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n,i=("undefined"!=typeof require&&require,(e,t,o)=>new Promise(((n,a)=>{var i=e=>{try{s(o.next(e))}catch(t){a(t)}},r=e=>{try{s(o.throw(e))}catch(t){a(t)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(i,r);s((o=o.apply(e,t)).next())})));import{_ as r,u as s}from"./useTable.7d8a6e5e.js";import{_ as l,u as d,a as c}from"./useForm.e9f08473.js";import{P as u}from"./index.24ce52d8.js";import{B as m,u as p,a as f}from"./index.21fd786f.js";import{a7 as g,m as h,B as b,j as I,N as x,n as j,O as y,V as w,Q as M,S as v,av as C,a1 as T}from"./vendor.8be1affb.js";import{m as k,a as P,b as R,c as S}from"./system.220e582e.js";import"./index.1c224cd3.js";import"./index.e1fec598.js";/* empty css              *//* empty css              *//* empty css              */import"./useContentViewHeight.1cc3b3a8.js";/* empty css              */import"./useSortable.92d684a3.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */const E=[{label:"标题",field:"Title",component:"Input",colProps:{span:4}},{label:"创建时间",field:"CreateTime",component:"RangePicker",colProps:{span:6},componentProps:{"show-time":!0}}],L=[{title:"编号",dataIndex:"Id",align:"center",width:80,sorter:!0},{title:"标题",dataIndex:"Title",align:"left",width:250,sorter:!0},{title:"类容",dataIndex:"Content",align:"left",sorter:!0},{title:"状态",dataIndex:"IsLocked",align:"center",width:100,customRender:({record:e})=>e.IsLocked?g("span",{className:"page-lock"},"锁定"):g("span",{className:"page-unlock"},"启用"),filters:[{text:"锁定",value:1},{text:"启用",value:0}],sorter:!0},{title:"创建时间",dataIndex:"CreateTime",width:160,sorter:!0}],O=[{label:"编号",field:"Id",defaultValue:0,component:"Input",show:!1},{label:"标题",field:"Title",defaultValue:"",component:"Input",rules:[{required:!0,message:"标题必须为2至50个字符"},{max:50,min:2,message:"标题必须为2至50个字符"}]},{label:"类容",field:"Content",defaultValue:"",component:"InputTextArea",componentProps:{rows:6},required:!1,show:!0}];var B=h({name:"AccountEditorModal",components:{BasicModal:m,BasicForm:l},emits:["success"],setup(e,{emit:r}){const s=b({Id:0}),[l,{setFieldsValue:c,resetFields:u,validate:m}]=d({labelWidth:100,schemas:O,showActionButtonGroup:!1,actionColOptions:{span:25}}),[f,{setModalProps:g,closeModal:h}]=p((e=>i(this,null,(function*(){s.Id=e.Id,u(),g({confirmLoading:!0,maskClosable:!1});const i=yield k({Id:e.Id});c(((e,i)=>{for(var r in i||(i={}))o.call(i,r)&&a(e,r,i[r]);if(t)for(var r of t(i))n.call(i,r)&&a(e,r,i[r]);return e})({},i)),g({confirmLoading:!1})}))));return{registerModal:f,registerForm:l,getTitle:I((()=>0==s.Id?"创建公告":"编辑公告")),handleSubmit:function(){return i(this,null,(function*(){try{const e=yield m();g({confirmLoading:!0}),yield P(e),h(),r("success")}catch(e){}finally{g({confirmLoading:!1})}}))}}}});B.render=function(e,t,o,n,a,i){const r=x("BasicForm"),s=x("BasicModal");return j(),y(s,v(e.$attrs,{onRegister:e.registerModal,title:e.getTitle,onOk:e.handleSubmit}),{default:w((()=>[M(r,{onRegister:e.registerForm},null,8,["onRegister"])])),_:1},16,["onRegister","title","onOk"])};var F=h({name:"MessageManager",components:{PageWrapper:u,BasicTable:r,TableAction:c,MessageEditorModal:B},setup(){const[e,{openModal:t}]=f(),[o,{reload:n}]=s({title:"公告管理",canColDrag:!0,showIndexColumn:!1,striped:!0,canResize:!0,columns:L,api:R,formConfig:{labelWidth:80,schemas:E},useSearchForm:!0,showTableSetting:!0,bordered:!0,actionColumn:{width:200,title:"操作",dataIndex:"action",slots:{customRender:"action"},fixed:"right"},showSummary:!1});function a(e){t(!0,null==e?{Id:0}:e)}function r(){n()}function l(e){return i(this,null,(function*(){try{yield S({Id:e.Id,IsLocked:!e.IsLocked}),n()}catch(t){}}))}return C("Enter",(e=>{var t;e.preventDefault(),"[object HTMLInputElement]"==(null==(t=e.target)?void 0:t.toString())&&r()})),{registerTable:o,handActionColumns:function(e){let t=[{title:"编辑",icon:"clarity:note-edit-line",onClick:()=>{a(e)}}];return e.IsLocked?t.push({title:"启用",icon:"ant-design:unlock-outlined",color:"success",onClick:()=>{l(e)}}):t.push({title:"锁定",icon:"ant-design:lock-outlined",color:"error",popConfirm:{title:"确定锁定",confirm:l.bind(null,e)}}),t},registerMessageEditorModal:e,handleEdit:a,handleRefresh:r}}});const A=T("创建公告");F.render=function(e,t,o,n,a,i){const r=x("a-button"),s=x("TableAction"),l=x("BasicTable"),d=x("MessageEditorModal"),c=x("PageWrapper");return j(),y(c,{dense:"",contentFullHeight:"",fixedHeight:""},{default:w((()=>[M(l,{onRegister:e.registerTable},{toolbar:w((()=>[M(r,{type:"primary",onClick:t[0]||(t[0]=t=>e.handleEdit(null))},{default:w((()=>[A])),_:1})])),action:w((({record:t})=>[M(s,{actions:e.handActionColumns(t)},null,8,["actions"])])),_:1},8,["onRegister"]),M(d,{onRegister:e.registerMessageEditorModal,onSuccess:e.handleRefresh},null,8,["onRegister","onSuccess"])])),_:1})};export{F as default};
